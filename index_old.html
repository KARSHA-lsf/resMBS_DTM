<html>
  <head>
    <link href="c3.min.css" rel="stylesheet" type="text/css">
  </head>
  <body>
    <div id="chart"></div>

    <script src="https://d3js.org/d3.v5.min.js" charset="utf-8"></script>
    <script src="c3.min.js"></script>
    <script>
     

      d3.csv('resMBS_DT_nomult_v1.csv')
        .then(function(data) {
          for (let index = 1; index < 2; index++) {
            var data_arr = data_procesor(data.filter(function(d){ return d.Topic == index }))

            var chart = c3.generate({
                data: {
                    x: 'year',
                    columns: data_arr
                }
            });
            
          }
          // console.log(data.filter(function(d){ return d.Topic == "1" }))
            
        })
        .catch(function(error){
          // handle error   
        })

        function data_procesor(data){

          var year = ['year',2002,2003,2004,2005,2006,2007,2008]
          
          var viz_data = []
          viz_data.push(year)
          //console.log(data)
          

          var comp_roles = d3.map(data, function(d){return(d.comp_role)}).keys()
          
          for(let i =1; i<comp_roles.length; i++){
            var weight = [comp_roles[i]]
            
            for(let yr = 2002; yr<2009;yr++){
              var level1 = data.filter(function(d){ return d.comp_role == comp_roles[i] && d.Year == yr })
              //var level1 = data.filter(function(d){ return d.Year == yr })

              if(level1.length>0){
                weight.push(level1[0]['weight'])
                
              }else{
                weight.push(null)
              }
              
              
             }
             viz_data.push(weight)
          }
        //  console.log(viz_data)
          return viz_data
        }

      </script>
      
      
      <script>

//       var chart = c3.generate({
//         data: {
//           columns: [
//             ['data1', 1030, 1200, 1100, 1400, 1150, 1250],
//             ['data2', 2130, 2100, 2140, 2200, 2150, 1850]
// //           ['data1', 30, 200, 100, 400, 150, 250],
// //           ['data2', 130, 100, 140, 200, 150, 50]
//           ],
//           type: 'bar',
//           onclick: function (d, element) { console.log("onclick", d, element); },
//           onmouseover: function (d) { console.log("onmouseover", d); },
//           onmouseout: function (d) { console.log("onmouseout", d); }
//         },
//         axis: {
//           x: {
//             type: 'categorized'
//           }
//         },
//         bar: {
//           width: {
//             ratio: 0.3,
// //            max: 30
//           },
//         }
//       });
    </script>
  </body>

  <div id="side_menu" class="treemenu boxed" >
      <div class="ui fluid styled accordion">
        <div class="title">
          <i class="dropdown icon"></i> Baseline
        </div>
        <div class="content">
          <div class="subtitle">Discription: ....
          </div>
          <div class="accordion">
            <div class="active title">
              <i class="dropdown icon"></i> Round 1
            </div>
            <div class="active content">
              <div class="subtitle">Level 1A Subtitles</div><br />
              <a class="item" href="http://www.google.com">Google</a>
              <button class="ui right labeled icon button">
                  <i class="right arrow icon"></i>
                  Visualization
              </button>
            </div>
            <div class="title">
              <i class="dropdown icon"></i> Level 1B
            </div>
            <div class="content">
              Level 1B Contents
            </div>
            <div class="title">
              <i class="dropdown icon"></i> Level 1C
            </div>
            <div class="content">
              Level 1C Contents
            </div>
          </div>
        </div>
        <div class="title">
          <i class="dropdown icon"></i> Level 2
        </div>
        <div class="content">
          <div class="subtitle">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla vel euismod purus. Donec nec tempor lorem, et consequat tellus. Sed id consequat nibh. Praesent a posuere mi. Ut gravida feugiat diam, non accumsan risus facilisis et. Donec ullamcorper
            facilisis magna a accumsan. Duis varius purus in dapibus interdum. Aenean a felis sit amet lectus interdum venenatis in imperdiet sapien. Sed at leo maximus, blandit orci ac, viverra orci.</div>
          <div class="accordion">
            <div class="active title">
              <i class="dropdown icon"></i> Level 2A
            </div>
            <div class="active content">
              <div class="subtitle">Level 2A Subtitles</div>
              <div class="accordion">
                <div class="title">
                  <i class="dropdown icon"></i> Level 2A-A
                </div>
                <div class="content">
                  Level 2A-A Contents
                </div>
                <div class="title">
                  <i class="dropdown icon"></i> Level 2A-B
                </div>
                <div class="content">
                  Level 2A-B Contents
                </div>
              </div>
            </div>
            <div class="title">
              <i class="dropdown icon"></i> Level 2B
            </div>
            <div class="content">
              Level 2B Contents
            </div>
            <div class="title">
              <i class="dropdown icon"></i> Level 2C
            </div>
            <div class="content">
              Level 2C Contents
            </div>
          </div>
        </div>
        
       
      </div>
  </div>
</html>
